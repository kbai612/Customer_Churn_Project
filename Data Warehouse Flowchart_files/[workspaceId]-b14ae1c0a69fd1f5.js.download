(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4144],{5087:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/workspace/[workspaceId]",function(){return t(80210)}])},67572:function(e,n,t){"use strict";var r=t(52322),u=t(57821),s=t(96933),i=t(71059);n.Z=function(e){var n=e.hideSplashOnLoad,t=void 0===n||n,o=e.children,a=(0,s.TZ)();return((0,i.Z)(function(){a&&t&&(0,u.hf)(!0)},[a,t]),a)?(0,r.jsx)(r.Fragment,{children:o}):null}},33816:function(e,n,t){"use strict";var r=t(25237),u=t.n(r),s=t(69803);window.hljs=s.ZP,n.Z=u()(function(){return Promise.all([t.e(6389),t.e(1539),t.e(8483),t.e(4526),t.e(5882),t.e(9005),t.e(6996),t.e(1498),t.e(3880),t.e(2338),t.e(9907),t.e(6946),t.e(8164),t.e(580),t.e(7276),t.e(2250),t.e(4188),t.e(1762),t.e(3815),t.e(2439),t.e(9096),t.e(4656),t.e(6859),t.e(9685),t.e(3981),t.e(4204),t.e(4432),t.e(9123),t.e(7478),t.e(3164),t.e(4583),t.e(3878)]).then(t.bind(t,51163))},{loadableGenerated:{webpack:function(){return[51163]}},ssr:!1})},89551:function(e,n,t){"use strict";t.d(n,{O:function(){return d}});var r=t(70865),u=t(96670),s=t(26297),i=t(2784),o=t(2595),a=t(39183),c=t(76592),l=t(89960);function d(){var e=(0,o.Z)(),n=(0,a.mT)();return{onError:(0,i.useCallback)(function(t){var i=(0,c.E)(t,"Unknown",{}),o=i.error,a=(0,s.Z)(i,["error"]);!1!==o.isSevere&&e.error(o.message,{id:o.message}),o.handled||(0,l.Tb)(o,(0,u.Z)((0,r.Z)({},a),{workspaceId:n}))},[n])}}},5566:function(e,n,t){"use strict";var r=t(2784),u=t(20578);n.Z=function(){(0,r.useEffect)(function(){return u.Z.init(),function(){return u.Z.dispose()}},[])}},96286:function(e,n,t){"use strict";var r=t(52322),u=(0,t(2784).memo)(function(){return(0,r.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n      body {\n        overflow: hidden;\n      }\n    "}})});u.displayName="WorkspaceBodyStyles",n.Z=u},10461:function(e,n,t){"use strict";var r=t(52322),u=t(58410),s=t(57821),i=t(39183),o=t(71059);n.Z=function(e){var n=e.hideSplashOnLoad,t=void 0===n||n,a=e.isEmbedIntegration,c=void 0!==a&&a,l=e.children,d=(0,i.Rx)(),f=(0,i.vP)(),v=(0,i.sx)();return((0,o.Z)(function(){d&&t&&(0,s.hf)()},[d,t]),d)?(null==v?void 0:v.hasAccess)?f?(0,r.jsx)(r.Fragment,{children:l}):(0,r.jsx)(u.Z,{statusCode:404,hideActionButtons:c}):(0,r.jsx)(u.Z,{statusCode:403,hideActionButtons:c}):null}},19377:function(e,n,t){"use strict";var r=t(52322),u=t(97729),s=t.n(u),i=t(39183);n.Z=function(){var e=(0,i.u0)();return e?(0,r.jsx)(s(),{children:(0,r.jsxs)("title",{children:[e," â€” Eraser"]})}):null}},13410:function(e,n,t){"use strict";var r=t(25237);n.Z=t.n(r)()(function(){return t.e(1941).then(t.bind(t,71941))},{loadableGenerated:{webpack:function(){return[71941]}},ssr:!1})},99811:function(e,n,t){"use strict";t.d(n,{fu:function(){return f},oQ:function(){return d}});var r=t(70865),u=t(96670),s=t(52322),i=t(2784),o=t(96933),a=t(39183),c=t(4406),l=t(45403),d=function(e){var n=Date.now(),t=[];return e.forEach(function(e){var r=e.id,u=e.heartbeat;n-(void 0===u?n:u)<=15e3&&t.push(r)}),t},f=function(e,n){var t=(0,l.fz)(function(e){return e.workspaceCollaborators},e);return(0,i.useMemo)(function(){var e=d(null!=t?t:[]);return n?e.filter(function(e){return e!==n}):e},[t,n])};n.ZP=function(e){var n=(0,o.II)(),t=(0,i.useState)([]),l=t[0],d=t[1],v=f((0,a.mT)()||"");return(0,i.useEffect)(function(){v&&d(v.filter(function(e){return e!==n}))},[n,v]),(0,s.jsx)(c.Z,(0,u.Z)((0,r.Z)({},e),{horizontalAlign:"end",max:3,userIds:l}))}},74726:function(e,n,t){"use strict";t.d(n,{P:function(){return d},X:function(){return l}});var r=t(52322),u=t(2784),s=t(64323),i=t(98916),o=t(96933),a=t(45403),c=t(56060),l=(0,u.createContext)({dismiss:function(){},wasDismissed:function(){return!1}}),d=function(e){var n,t=e.tutorialId,d=e.children,f=(0,u.useState)([]),v=f[0],h=f[1],p=(0,i.b)().activations,m=(0,o.aF)(),_=(0,a.Pe)();(0,u.useEffect)(function(){var e;h((null==m||null==(e=m.userSettings)?void 0:e.dismissedHints)||[])},[null==m||null==(n=m.userSettings)?void 0:n.dismissedHints]);var I=(0,u.useCallback)(function(e){return v.includes(e)},[v]),g=(0,u.useCallback)(function(e){if(m&&e&&!I(e)){var n=v.concat(e);h(n),_.currentUser.updateCurrentUser({userSettings:{dismissedHints:n}})}},[m,v,I]);return(0,u.useEffect)(function(){p[c.c.AddFigure]&&g(s.X.ORGANIZE_WITH_FIGURES),p[c.c.AddFigureEmbed]&&g(s.X.EMBED_FIGURE_IN_DOCUMENT),p[c.c.AddComment]&&g(s.X.LEAVE_COMMENT)},[p,g]),(0,r.jsx)(l.Provider,{value:{activeTutorialId:t,dismiss:g,wasDismissed:I},children:d})}},93322:function(e,n,t){"use strict";t.d(n,{Sh:function(){return b},ZP:function(){return k}});var r,u=t(70865),s=t(96670),i=t(52322),o=t(2784),a=t(18149),c=t.n(a),l=t(5632),d=t(20578),f=t(57685),v=t(39183),h=t(355),p=t(75194),m=t(27196),_=t(61534),I=t(99669),g="layout-sizes",E=[1,1],w=_.X.Document,A=function(){var e,n,t,u,s,i,a,A=(0,f.K)(),Z=(0,p.d)(),b=(0,l.useRouter)().route,k=(0,o.useState)(0),U=k[0],C=k[1],T=(0,o.useState)((e=A,n=Z,t=b.endsWith("/embed"),u=e.layout,s=e.element,i=e.elements,a=(0,v.ZP)(),"string"==typeof u&&(0,h.$)(u)?u:s||i?_.X.Canvas:(null==a?void 0:a.hasFigureEmbed)?_.X.Document:(null==a?void 0:a.hasDrawing)===(null==a?void 0:a.hasNotes)?t?_.X.Canvas:n?w:_.X.Both:(null==a?void 0:a.hasDrawing)?_.X.Canvas:_.X.Document)),R=T[0],S=T[1],x=(0,o.useState)((r||(r=I.J.getItem(g)||E),r)),y=x[0],M=x[1],O=(0,m.D9)(y),N=(0,m.D9)(R);(0,o.useEffect)(function(){null==R||c()(R,N)||I.J.setItem("layout-mode",R)},[R,N]),(0,o.useEffect)(function(){null==y||c()(y,O)||I.J.setItem(g,y)},[y,O]),(0,o.useEffect)(function(){Z&&R===_.X.Both&&S(w)},[Z,R]);var j=(0,o.useMemo)(function(){switch(R){case _.X.Canvas:return[!1,!0];case _.X.Document:return[!0,!1];default:return[!0,!0]}},[R]);return(0,o.useEffect)(function(){d.Z.emit("layout-ready",S)},[]),{sizes:y,visibilities:j,setSizes:M,setLayout:S,offsetTop:U,setOffsetTop:C,layout:R}},Z=(0,o.createContext)(void 0),b=function(e){var n=e.children,t=A(),r=(0,o.useState)(!1),a=r[0],c=r[1],l=(0,o.useState)(!1),d=l[0],f=l[1],v=(0,o.useState)(!1),h=v[0],p=v[1],m=(0,o.useState)(!0),_=m[0],I=m[1],g=(0,o.useState)(!0),E=g[0],w=g[1],b=(0,o.useCallback)(function(){c(function(e){return!e})},[]);return(0,i.jsx)(Z.Provider,{value:(0,s.Z)((0,u.Z)({},t),{isNotepadReady:d,isWhiteboardReady:h,isWhiteboardEmpty:_,isNotepadEmpty:E,isUiHidden:a,toggleUi:b,setNotepadReady:f,setWhiteboardReady:p,setWhiteboardEmpty:I,setNotepadEmpty:w}),children:n})},k=Z},7685:function(e,n,t){"use strict";t.d(n,{X:function(){return U}});var r=t(70865),u=t(96670),s=t(87394),i=t(52322),o=t(2784),a=t(5632),c=t(69071),l=t(37164),d=t(2595),f=t(51716),v=t(28378),h=t(45403),p=t(89551),m=t(11269),_=t(96933),I=t(98788),g=t(22970),E=t(89813),w=t(71059),A=t(89960),Z=t(38947),b=function(e,n,t){var r=(0,h.Pe)(),u=(0,o.useState)(),s=u[0],i=u[1],a=void 0!==n,c=null==n?void 0:n.id,l=null==n?void 0:n.teamId;return(0,o.useEffect)(function(){a&&e&&c&&l?r.workspaceMembers.isWorkspaceMember(c,e).then(i):i(!1)},[c,l,e,a]),(0,o.useMemo)(function(){if(void 0!==s&&null!=t)return{isMember:s,hasAccess:t.read,isReadOnly:t.read&&!t.write}},[s,t])},k=function(e){var n=e.teamId,t=e.workspaceId,r=(0,h.Pe)(),u=(0,c.f)(r.workspaces.getWorkspaceTeamInfo),s=u.execute,i=u.loading,a=u.result;return(0,o.useEffect)(function(){n&&t&&s(n,t)},[n,t,s]),{loading:i,teamInfo:a}},U=function(e){var n,t,U,C,T,R,S,x,y,M,O,N,j,P,D,X,G,B,F,L,W,J,H=e.workspaceId,z=e.environment,K=void 0===z?"default":z,q=e.externalUserId,V=e.children,Q=(0,a.useRouter)(),$=(0,h.Pe)(),Y=(0,m.mZ)(),ee=(0,m.LP)(),en=(0,s.Z)((0,m.p3)(),2)[1],et=(0,o.useState)({environment:K}),er=et[0],eu=et[1],es=(0,_.II)(),ei=q||es,eo=(0,_.g5)(),ea=(0,o.useState)(void 0),ec=ea[0],el=ea[1];(0,o.useEffect)(function(){eu({environment:K}),em.current=!1},[K,H]),(0,o.useEffect)(function(){if(el(void 0),H)return $.workspaces.subscribeById(H,function(e,n){n?el(null):el(e)})},[H]);var ed=k({workspaceId:H,teamId:null==ec?void 0:ec.teamId}).teamInfo,ef=(n=(0,h.Pe)(),U=(t=(0,o.useState)({result:null,loading:!0,error:null}))[0],C=t[1],(T=(0,o.useRef)(U)).current=U,R=(0,_.II)(),(S=(0,o.useRef)(R)).current=R,x=(0,_.TZ)(),y=(0,o.useCallback)(function(e,t,r,u){var s,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;u&&e&&(T.current.loading=!0,C(function(e){return{result:r?null:e.result,loading:!0,error:null}}),n.workspaces.validateAccess({workspaceId:e,userId:t}).then(function(e){t===S.current&&C({result:e,loading:!1})}).catch((s=(0,I.Z)(function(n){return(0,g.__generator)(this,function(s){switch(s.label){case 0:if(t!==S.current)return[2];if(!(i>5))return[3,1];return C({error:n,loading:!1,result:null}),[2];case 1:return[4,(0,E.Z)(200)];case 2:return s.sent(),[2,y(e,t,r,u,i+1)];case 3:return[2]}})}),function(e){return s.apply(this,arguments)})))},[]),(0,o.useEffect)(function(){y(H,R,!0,x)},[H,y,R,x]),(0,o.useEffect)(function(){if(H&&R&&!U.loading){var e=n.workspaceAccess.subscribeToAccessChanges(H,R,function(e){var n,t,r=T.current;!r.loading&&(e?(C({result:e,loading:!1,error:null}),r.result&&(e.read!==(null==(n=r.result)?void 0:n.read)||e.write!==(null==(t=r.result)?void 0:t.write))&&y(H,R,!1,!0)):y(H,R,!1,!0))});return function(){e()}}},[y,H,R,U.loading]),U),ev=ef.result,eh=ef.error,ep=b(ei,ec,ev);(0,o.useEffect)(function(){eu(function(e){return(0,u.Z)((0,r.Z)({},e),{access:ep,teamInfo:ed,showTeamJoinBanner:!!(null==ed?void 0:ed.canJoinTeam)})})},[ep,ed]);var em=(0,o.useRef)(!1),e_=(0,c.Z)($.workspaces.markWorkspaceAsVisited),eI=Q.pathname.includes("/image");(0,o.useEffect)(function(){if(!e_.loading&&!em.current&&ec&&ei&&!eo&&!eI){var e=ec.id;e_.execute(e).catch(A.Tb),em.current=!0}},[ei,ec,e_,eo,eI]),(0,w.Z)(function(){ec&&ee&&ec.teamId&&ec.teamId!==ee&&Y.has(ec.teamId)&&en(ec.teamId)},[ec,ee,Y,en]);var eg=(O=(M={userId:ei,workspaceId:H}).workspaceId,N=M.userId,j=(0,h.Pe)(),P=(0,d.Z)(),D=(0,f.Z)(),G=(X=(0,o.useState)(0))[0],B=X[1],F=(0,o.useCallback)(function(){return B(function(e){return e+1})},[]),L=(0,p.O)().onError,J=null==(W=(0,o.useMemo)(function(){if(N&&O){var e=(0,l.x0)(),n=j.makeNotesAccessor({workspaceId:O,userId:N,clientId:e});return new v.W({userId:N,clientId:e,adapter:n,onError:L,onConnectionChange:function(e){e&&P.success("Connection to server re-established.",{id:"connection"}),D()}})}},[O,N,D,G]))?void 0:W.isReady,(0,o.useEffect)(function(){if(!J){null==W||W.getInitialData().then(D);return}if(J)return function(){null==W||W.destroy()}},[W,J,D]),{collab:J?W:void 0,restartCollab:F}),eE=eg.collab,ew=eg.restartCollab,eA=(0,o.useRef)({});(0,o.useEffect)(function(){var e=null==ep?void 0:ep.hasAccess,n=null==ep?void 0:ep.isReadOnly,t=eA.current,r=!1===t.hasAccess&&!0===e,u=!0===t.isReadOnly&&!1===n,s=!1===t.isReadOnly&&!0===n;(r||u||s)&&ew(),eA.current={hasAccess:e,isReadOnly:n}},[null==ep?void 0:ep.hasAccess,null==ep?void 0:ep.isReadOnly,ew]);var eZ=(0,o.useCallback)(function(){eu(function(e){return(0,u.Z)((0,r.Z)({},e),{showTeamJoinBanner:!1})})},[]),eb=(0,o.useMemo)(function(){return(0,u.Z)((0,r.Z)({},er),{workspace:ec,slateCollab:eE,restartSlateCollab:ew,hideTeamJoinBanner:eZ})},[er,eE,ew,ec,eZ]);return ev||eh?(0,i.jsx)(Z.e.Provider,{value:eb,children:V}):null}},32489:function(e,n,t){"use strict";t.d(n,{s:function(){return u}});var r=t(57685),u=function(){return"true"===(0,r.K)().embed}},34809:function(e,n,t){"use strict";var r=t(2784),u=t(93322);n.Z=function(){return(0,r.useContext)(u.ZP)}},80210:function(e,n,t){"use strict";t.r(n),t.d(n,{__N_SSP:function(){return W},default:function(){return J}});var r=t(52322),u=t(2784),s=t(5632),i=t.n(s),o=t(67572),a=t(58410),c=t(66140),l=t(99811),d=t(23630),f=t(32489),v=t(52982),h=t(45403),p=t(34809),m=t(10847),_=t(96933),I=t(2332),g=t(39183),E=t(42541),w=t(6021),A=t(20417),Z=t(95162),b=t(88404),k=t(75194),U=t(59711),C=t(35773),T=t.n(C),R=function(e){var n=e.ownerId,t=(0,I.ZP)(null!=n?n:"");return t?(0,r.jsxs)("p",{children:["Create a free account to collaborate with ",t.displayName,". By signing up, you agree to our ",(0,r.jsx)("a",{href:"".concat(c.CF.url,"/terms"),children:"terms of service"})]}):null},S=function(){var e,n,t=(0,f.s)(),s=(0,k.d)(),o=(0,_.fC)(),a=(0,_.TF)(o),c=(0,m.E)("skip_file_auth_team_ids").value,I=(0,g.bm)(),C=I.teamInfo,S=I.workspace,x="integration"===I.environment,y=(0,l.fu)((null==(e=I.workspace)?void 0:e.id)||"",null==o?void 0:o.id),M=(0,p.Z)().setOffsetTop,O=(0,u.useState)(a&&!t&&!s),N=O[0],j=O[1],P=(0,u.useContext)(v.Z),D=(0,h.Pe)(),X=(null==C?void 0:C.id)&&((null==c?void 0:c.includes(C.id))||(null==S?void 0:S.isAnonymousAccessAllowed)||(null==S?void 0:S.directAccessMode)===U.lL.Read),G=C&&c&&!X&&!x&&N;(0,u.useEffect)(function(){M(40*!!N)},[N,M]),(0,u.useEffect)(function(){var e=function(){var e=D.currentUser.getAuthUser();(null==e?void 0:e.isAnonymous)||(B.current=!1,P.closeAuthModal(),j(!1))},n=function(){e();var n,t=D.currentUser.getAuthUser();i().replace(((n=new URLSearchParams(window.location.search)).set(d.eX,"true"),"".concat(window.location.pathname,"?").concat(n.toString()))),(null==C?void 0:C.isAutoJoinEnabled)&&(null==t?void 0:t.id)&&(0,w.Z)(C.id,t.id,{isAutoJoin:!0,origin:"workspace"}).catch(function(){})};return D.currentUser.on(D.currentUser.Events.UserSignedUp,n),D.currentUser.on(D.currentUser.Events.AuthUserChanged,e),function(){D.currentUser.off(D.currentUser.Events.UserSignedUp,n),D.currentUser.off(D.currentUser.Events.AuthUserChanged,e)}},[C,P.closeAuthModal]);var B=(0,u.useRef)(!1);(0,u.useEffect)(function(){if(G&&a){var e;E.Z.trackEvent(null,"page_view",{page_title:"Sign Up",page_location:"".concat(document.location.origin,"/auth/sign-up"),page_path:"/auth/sign-up",embedded_at_path:i().asPath}),B.current=!0,P.openSignUpModal({isClosable:!1,customSubTitle:(0,r.jsx)(R,{ownerId:null==(e=I.workspace)?void 0:e.ownerId}),profileArgs:{signUpOrigin:"workspace"}})}else B.current&&(B.current=!1,P.closeAuthModal())},[G,P.openSignUpModal,P.closeAuthModal,a,null==(n=I.workspace)?void 0:n.ownerId]);var F=(0,u.useCallback)(function(){E.Z.trackEvent("auth_banner","sign_up_click",{teamId:null==C?void 0:C.id,teamDomain:null==C?void 0:C.domain,teamAutoJoinEnabled:null==C?void 0:C.isAutoJoinEnabled,activeCollaborarCount:y.length}),E.Z.trackEvent(null,"page_view",{page_title:"Sign Up",page_location:"".concat(document.location.origin,"/auth/sign-up"),page_path:"/auth/sign-up",embedded_at_path:i().asPath}),P.openSignUpModal({isClosable:!0,profileArgs:{signUpOrigin:x?"integration":"workspace"}})},[C,P.openSignUpModal,y,x]);return!N||G?null:(0,r.jsx)("div",{className:T().header,children:(0,r.jsxs)("div",{className:T().wrapper,"data-testid":"auth-banner",children:[(0,r.jsx)("div",{className:T().text,children:"Create multiple files and share everything with your team."}),(0,r.jsx)(Z.ZP,{className:T().signIn,onClick:F,children:"Sign Up Free"}),(0,r.jsx)("div",{className:T().close,children:(0,r.jsx)(b.J,{icon:A.Z,onClick:function(){return j(!1)}})})]})})},x=t(33816),y=t(5566),M=t(96286),O=t(10461),N=t(19377),j=t(13410),P=t(93322),D=t(7685),X=t(11269),G=t(57685),B=t(2600),F=function(e){var n=e.workspaceId,t=(0,G.K)(),r=(0,X.LP)(),s=(0,u.useState)(!1),i=s[0],o=s[1],a=(0,B.X)().request;return(0,u.useEffect)(function(){"duplicate"!==t.action||n&&"string"==typeof n&&r&&!i&&(o(!0),a({workspaceId:n,teamId:r},{reload:!0}))},[r,a,i,t.action,n]),null},L=t(74726),W=!0,J=function(){var e=(0,s.useRouter)(),n=e.query.workspaceId;return((0,y.Z)(),F({workspaceId:n}),e.isReady)?"string"!=typeof n?(0,r.jsx)(a.Z,{statusCode:404,title:"File not found"}):(0,r.jsxs)("div",{className:"workspace",children:[(0,r.jsx)(o.Z,{hideSplashOnLoad:!1,children:(0,r.jsx)(D.X,{workspaceId:n,children:(0,r.jsx)(L.P,{children:(0,r.jsxs)(O.Z,{children:[(0,r.jsx)(N.Z,{}),(0,r.jsx)(j.Z,{}),(0,r.jsxs)(P.Sh,{children:[(0,r.jsx)(S,{}),(0,r.jsx)(x.Z,{})]})]})})})}),(0,r.jsx)(M.Z,{})]}):null}},64323:function(e,n,t){"use strict";var r,u;t.d(n,{X:function(){return r}}),(u=r||(r={})).DIAGRAM_GPT_TOUR="DIAGRAM_GPT_TOUR",u.PRODUCT_TOUR="PRODUCT_TOUR",u.INSERT_MENU_TUTORIAL="INSERT_MENU_TUTORIAL",u.MAKE_A_FIGURE_TUTORIAL="MAKE_A_FIGURE_TUTORIAL",u.DIAGRAM_WITH_CODE_TUTORIAL="DIAGRAM_WITH_CODE_TUTORIAL",u.EMBED_FIGURE_IN_DOCUMENT="EMBED_FIGURE_IN_DOCUMENT",u.LEAVE_COMMENT="LEAVE_COMMENT",u.ORGANIZE_WITH_FIGURES="ORGANIZE_WITH_FIGURES"},35773:function(e){e.exports={header:"AuthBanner_header__hgvMD",wrapper:"AuthBanner_wrapper__Cznaq",text:"AuthBanner_text__SBtet",signIn:"AuthBanner_signIn__ugcMl",close:"AuthBanner_close__FmqGy"}}},function(e){e.O(0,[2888],function(){return e(e.s=5087)}),_N_E=e.O()}]);